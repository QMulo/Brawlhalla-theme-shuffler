# Brawlhalla-theme-shuffler

Shuffle between [Brawlhalla](http://www.brawlhalla.com/) map themes/assets quickly.

BMG devs have gone out of their way to make modding stages, the UI, and the in-game music as simple as possible. Nearly all stage assets are stored as simple, editable images files (png, jpg), with stage music stored as mp3 files.

In addition to the stages, nearly all UI elements are customizable - this includes stage backgrounds, buttons, borders, and even the daily rotating "tiles" on the landing page.

This script allows you to quickly shuffle the 


## Setup/installation

Install [python](https://www.python.org/downloads/)

Clone this repo (or download/unzip)

Edit `config.json` as necessary:

   `brawlhalla_home` - directory where Brawlhalla is located (will also try default Steam install directories)

   `allow_defaults` - include the default map textures/assets as an option when randomly selecting a theme. By default, the original assets will not be used if there is at least one alternative are available. 

   `asset_dir` - where your custom themes are stored (and where backups of the original assets will be stored). 


### Folder/File Structure

Assets in `asset_dir` must be stored in the following structure (see "examples" folder)

```
  - {Map Name}
    - {Skin Name}
        - mapArt
          - Backgrounds
          - {Map Name}
        - images
          - thumbnails
          - ...
        - mp3
```

#### Notes on folder names

All file/folder names are case-sensitive

Do not name any skin folders "default" (autogenerated by script)


All folders/subfolders/files are optional. For example, not every skin/theme has mp3 files, or you may not want to alter thumbnail images.

Blacklist: Prefix a skin name with "disable" to disable the skin as an option (eg, "disable - My Small Brawlhaven Theme") - great if there's one or two joke maps or WIP maps you want to temporarily disable

Whitelist: If any skin names in a folder start with "force", the script will only choose skins from those folders. Great if you want to try out a single new map, or if you have a large number of options and want to narrow it down to 1-or-2.

It is recommended to have one directory per-map. However, if you want to create additional folders, you will need to update `config.json`.

If `included_folders` is configured, the script will only look in those folders, and in the order they are listed. Otherwise, the script will look in every folder in `asset_dir` that is not in `excluded_folders`.

For example, in the `examples` folder, there are custom assets stored in `UI/My Custom UI`, and `UI` has been added to the `included_maps` section of the config file.


## Using the script

The `batch_scripts/` directory includes batch scripts for shortcuts/double-click/macros convenience on Windows

Start the script using one of these methods:
- Double-click: `batch_scripts/brawlhalla_shuffle.bat` 
- Command line: `python brawlhalla_shuffle.py`

The script will perform the following:

- Read `config.json`
- Find every directory in the `included_maps`  `asset_dir`
- For each folder within `asset_dir`, determine what skins are available, and select one at random
- Find all files within that skin folder that also exist in the Brawlhalla asset directory. 
- For each of those files:
  - If the file has not been backed up, create a copy of the original file in the `default` skin folder
  - Overwrite the file in the Brawlhalla directory with the skin's file
  - Any files in the skin folder that do not exist in the Brawlhalla home assets will not be copied 

### When changes take effect

Map assets are loaded at the beginning of each match. You can run the script during or between matches, and the new maps will be loaded before your next match. Your changes will not be shown with in a match - however, if you leave, load a new theme, then rejoin a match, your changes will show.

UI assets, however, are loaded at the start of the game. You will have to exit and restart if you want to change UI elements, including map thumbnails.

### Reset to Original Files

#### Using Steam

Right click on the game in steam, navigating to Properties > Local Files > Verify Integrity of Game Files. Steam will detect that your local files have been altered and will redownload/overwrite them with the official assets

#### Using the script

Run `python brawlhalla_shuffle.py -r`, or start `batch_scripts/reset_to_default.bat`

## Where to get themes

The easiest place to get started [brawlhallamods.blogspot.com](https://brawlhallamods.blogspot.com/) by [lmiol](https://steamcommunity.com/sharedfiles/filedetails/?id=1220997335) - he all of the maps consistently organized, and his FAQ is the simplest way to manually import modded maps 

Additional themes available at [gamebanana](https://gamebanana.com/maps/games/5704).